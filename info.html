<style>
    body { background: transparent; color: white; font-family: sans-serif; }
    .timeline-container { width: 350px; }
    
    /* Next（一番近い未来） */
    .next-card {
        background: rgba(0,0,0,0.8);
        border-left: 8px solid #ffd700;
        padding: 15px;
        margin-bottom: 10px;
        animation: pulse 2s infinite; /* 少し光らせる */
    }
    .next-label { color: #ffd700; font-size: 14px; font-weight: bold; }
    .next-title { font-size: 24px; font-weight: bold; margin: 5px 0; }
    .next-detail { font-size: 16px; color: #ccc; border-top: 1px solid #444; padding-top: 5px; }

    /* 未来の控え */
    .future-item {
        background: rgba(0,0,0,0.5);
        border-left: 4px solid #666;
        padding: 8px 12px;
        margin-bottom: 5px;
        font-size: 14px;
        opacity: 0.7;
    }
    @keyframes pulse { 0% { box-shadow: 0 0 0px #ffd700; } 50% { box-shadow: 0 0 15px #ffd700; } 100% { box-shadow: 0 0 0px #ffd700; } }
</style>

<div class="timeline-container" id="displayArea">
    </div>

<script>
    // Firebase設定...
    const firebaseConfig = {
        apiKey: "AIzaSyCG9-jWeEglWYEL1eYymQSI5XZjmv39-kk",
        authDomain: "raine-overlay-projects.firebaseapp.com",
        databaseURL: "https://raine-overlay-projects-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "raine-overlay-projects",
        storageBucket: "raine-overlay-projects.firebasestorage.app",
        messagingSenderId: "116002218964",
        appId: "1:116002218964:web:616f3503eaebacb4442c41"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    
    db.ref('counter').on('value', (snapshot) => {
        const data = snapshot.val();
        if(!data) return;

        const curTime = data.currentTime || 0;
        const saved = data.savedMemos || {};
        
        // 全ギミックを時間順に並べる
        const all = Object.values(saved).sort((a,b) => a.timeSec - b.timeSec);
        
        // 「まだ来ていない」ギミックだけ抽出
        const upcoming = all.filter(m => m.timeSec >= curTime);
        
        const displayArea = document.getElementById('displayArea');
        displayArea.innerHTML = "";

        if(upcoming.length > 0) {
            // 1つ目：Nextとして表示
            const next = upcoming[0];
            const nextHtml = `
                <div class="next-card">
                    <div class="next-label">Next: ${next.timeStr}</div>
                    <div class="next-title">${next.title}</div>
                    <div class="next-detail">${next.detail}</div>
                </div>
            `;
            displayArea.innerHTML += nextHtml;

            // 2つ目以降：控えとして表示 (最大2つ)
            upcoming.slice(1, 3).forEach(m => {
                displayArea.innerHTML += `
                    <div class="future-item">
                        <span>[${m.timeStr}] ${m.title}</span>
                    </div>
                `;
            });
        } else {
            displayArea.innerHTML = "<div>Wait for Start...</div>";
        }
    });
</script>