<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>

    <style>
        /* デザインは前回と同じ（一部ボタンを大きく調整） */
        body { background-color: rgba(0, 0, 0, 0); font-family: "Meiryo", sans-serif; color: #f0edea; display: flex; justify-content: flex-start; align-items: center; overflow: hidden; user-select: none; }
        .counter-container { background: rgba(20, 20, 20, 0.85); border: 2px solid #c0a870; border-radius: 8px; padding: 15px 25px; display: flex; gap: 40px; box-shadow: 0 4px 15px rgba(0,0,0,0.5); }
        .group { text-align: center; }
        .label { font-size: 16px; color: #c0a870; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 8px; }
        .number { font-size: 48px; font-weight: bold; font-family: 'Times New Roman', serif; text-shadow: 0 0 10px rgba(192, 168, 112, 0.5); }
        .controls { margin-top: 10px; display: flex; gap: 10px; justify-content: center; }
        button { background: #333; color: white; border: 1px solid #c0a870; border-radius: 4px; cursor: pointer; width: 40px; height: 40px; font-size: 20px; }
        button:active { background: #c0a870; color: #000; }
        button.reset { font-size: 12px; width: auto; padding: 0 10px; }
    </style>
</head>
<body>

<div class="counter-container">
    <div class="group">
        <div class="label">Sets</div>
        <div id="setNum" class="number">-</div>
        <div class="controls">
            <button onclick="change('setNum', -1)">-</button>
            <button onclick="change('setNum', 1)">+</button>
            <button class="reset" onclick="reset('setNum', 1)">Reset</button>
        </div>
    </div>
    <div class="group">
        <div class="label">Pulls</div>
        <div id="pullNum" class="number">-</div>
        <div class="controls">
            <button onclick="change('pullNum', -1)">-</button>
            <button onclick="change('pullNum', 1)">+</button>
            <button class="reset" onclick="reset('pullNum', 0)">Reset</button>
        </div>
    </div>
</div>

<script>
    // --- ここにあなたのFirebaseの設定を貼り付けてください ---
    const firebaseConfig = {
        apiKey: "AIzaSyCG9-jWeEglWYEL1eYymQSI5XZjmv39-kk",
        authDomain: "raine-overlay-projects.firebaseapp.com",
        databaseURL: "https://raine-overlay-projects-default-rtdb.asia-southeast1.firebasedatabase.app",
        projectId: "raine-overlay-projects",
        storageBucket: "raine-overlay-projects.firebasestorage.app",
        messagingSenderId: "116002218964",
        appId: "1:116002218964:web:616f3503eaebacb4442c41"
    };
    // --------------------------------------------------

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

// データの変更を監視
    db.ref('counter').on('value', (snapshot) => {
        const data = snapshot.val();
        console.log("読み込んだデータ:", data); // デバッグ用

        if (data) {
            // データが存在すれば画面を更新
            document.getElementById('setNum').innerText = data.setNum !== undefined ? data.setNum : 1;
            document.getElementById('pullNum').innerText = data.pullNum !== undefined ? data.pullNum : 0;
        } else {
            // データが空(null)だった場合、Firebase側に初期値を作成しにいく
            db.ref('counter').set({ setNum: 1, pullNum: 0 });
        }
    }, (error) => {
        console.error("読み込みエラー:", error);
    });

    // データを更新する関数
    function change(id, delta) {
        const el = document.getElementById(id);
        const currentVal = parseInt(el.innerText);
        
        // 画面が「-」のまま（NaN）なら計算しない
        if (isNaN(currentVal)) {
            console.error("まだ数字が読み込めていません");
            return;
        }

        let newVal = currentVal + delta;
        if (newVal < 0) newVal = 0;
        
        db.ref('counter').update({ [id]: newVal });
    }

    function reset(id, startVal) {
        if(confirm('リセットしますか？')) {
            db.ref('counter').update({ [id]: startVal });
        }
    }
</script>
</script>
</body>
</html>
